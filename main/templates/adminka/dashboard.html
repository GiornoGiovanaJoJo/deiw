{% extends 'adminka/base.html' %}
{% load static %}

{% block title %}Панель управления - Empire Premium{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'adminka/css/pages/index.css' %}" />
{% endblock %}

{% block content %}
<main class="dashboard">
  <h1><span data-i18n="index.welcome">Добро пожаловать,</span> {{ admin_name }}!</h1>

  {% if messages %}
    {% for message in messages %}
      <div class="form-message {% if message.tags %}{{ message.tags }}{% endif %}" style="margin-bottom: 1rem;">
        {{ message }}
      </div>
    {% endfor %}
  {% endif %}

  <div class="stats" data-aos="fade-up" data-aos-delay="100">
    <div class="stat-card">
      <h2>{{ stats.total_projects }}</h2>
      <p data-i18n="index.stats.projects">Всего проектов</p>
    </div>
    <div class="stat-card">
      <h2>{{ stats.completed_projects }}</h2>
      <p data-i18n="index.stats.completed">Завершенных</p>
    </div>
    <div class="stat-card">
      <h2>{{ stats.in_progress_projects }}</h2>
      <p data-i18n="index.stats.in_progress">В работе</p>
    </div>
    <div class="stat-card">
      <h2>{{ stats.new_requests }}</h2>
      <p data-i18n="index.stats.new_requests">Новых заявок</p>
    </div>
  </div>

  <div class="card orders-card" data-aos="fade-up" data-aos-delay="500">
    <h2 data-i18n="index.requests.title">Последние заявки</h2>
    {% if recent_requests %}
    <table class="orders-table">
      <thead>
        <tr>
          <th data-i18n="index.requests.id">ID</th>
          <th data-i18n="index.requests.name">Имя</th>
          <th data-i18n="index.requests.email">Email</th>
          <th data-i18n="index.requests.status">Статус</th>
          <th data-i18n="index.requests.date">Дата</th>
        </tr>
      </thead>
      <tbody>
        {% for request in recent_requests %}
        <tr>
          <td>{{ request.id }}</td>
          <td>{{ request.name }}</td>
          <td>{{ request.email }}</td>
          <td class="status-{% if request.status == 'new' %}warning{% elif request.status == 'closed' %}success{% else %}info{% endif %}" data-i18n="support.status.{{ request.status }}">
            {{ request.get_status_display }}
          </td>
          <td>{{ request.created_at|date:"d.m.Y H:i" }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
    {% else %}
    <p style="text-align: center; padding: 2rem; color: var(--color-text-muted);">Нет новых заявок</p>
    {% endif %}
  </div>
</main>
{% endblock %}
